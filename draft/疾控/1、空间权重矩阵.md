---
title: cdc spatial weight matrix
post: false
---

下图中镇江和扬州、南京、泰州、常州相邻。在程序计算中该如何表达他们的关系呢？

<!-- more -->



![image-20190406200704489](assets/image-20190406200704489.png)

比较好的方法是用空间矩阵来表示：

| 关系 | 南京 | 镇江 | ...  | 无锡 |
| ---- | ---- | ---- | ---- | ---- |
| 南京 | 0    | 1    | ...  | 0    |
| 镇江 | 1    | 0    | ...  | 0    |
| ...  | ...  | ...  | 0    | ...  |
| 无锡 | 0    | 0    | ...  | 0    |

用一个 N 阶方阵  $$w_{ij}  ( i = N, j = N)$$ ，来表示数据之间的空间结构，即空间单元 i 和空间单元 j 在空间上的邻近关系。其基础形式为：
$$
\begin{bmatrix}
   0 & w_{12} & \cdots & w_{1n} \\
   w_{21} & 0 & \cdots & w_{2n} \\
   \vdots & \vdots & \ddots & \vdots \\
   w_{n1} & w_{n2} & \cdots & 0
  \end{bmatrix} \tag{1}
$$
对于公式 ( 1 ) 所示的空间截面权重矩阵的基础形式有两点需要说明:

① 矩阵的对角线上元素都是 0 , 这说明任意一个空间截面都不能与自身发生空间联系; 

② 矩阵元素均要按公式 $w_{ij}^*= w_{ij} / \sum_{i=1}^N w_{ij}​$ 做行和单位化处理,对于每个空间单元而言:  $\sum_{i = n}^N w_{ij}^* = 1​$,
即空间权重矩阵每行之和为 1。这样做的好处是行和单位化后空间权重矩阵就变成了无量纲, 此时权重矩阵就只反映空间相关结构。



一般认为空间权值随着空间距离的增加而减少,随着区域公共边界长度的增加而增加。随着空间杈重的理论研究不断进展,以截面权重矩阵基础形式为模板衍生岀了多种空间权重矩阵, 在计量经济学中, 常见的空间权重矩阵设置的方式有基于邻近关系、距离关系和经济关系的原则,以及更为复杂的嵌套空间权重矩阵。以下对常见的空间权重矩阵的设置方式进行简要介绍。

( 1 ) 基于邻近关系的空间权重矩阵

Rook 准则：若空间单元 i 和 j 拥有共同的边界，则 $ w_{ij} = 1 ​$  ，否则  $w_{ij} = 0​$ 

Bishop 准则：若空间单元 i 和 j 拥有共同的顶点，则 $ w_{ij} = 1 ​$ ，否则  $ w_{ij} = 0 ​$ 

Queen 准则：若空间单元 i 和 j 拥有共同的边界或顶点，则 $w_{ij} = 1​$ ，否则  $ w_{ij} = 0 ​$ 



( 2 ) 基于距离关系的空间权重矩阵

基于距离的空间权重矩阵是假定空间之间的相互作用随着距离的增加而减小,而我们在计算不同区域之间的距离时,一般以不同区域质心之间的距离来代替。关于空间距离的度量,主要有欧式距离( Euclidean distance)、马氏距离( Mahalanobis distance)和弧度距离( Arc distance)。实际应用中以欧式距离居多。对于空间单元 i 和 j , 其坐标分别为 $(x_i, y_i)​$ , $(x_j, y_j)​$ , 那么两点之间的欧式距离为:  $d_{ij} = \sqrt{ (x_i - x_j)^2 + (y_i - y_j)^2 }​$

1 )  阈值权重矩阵

依据某一固定距离D来对两地空间关系进行赋值,我们称之阈值权重矩阵。对于空间单元 i 和 j ,其距离为 $ d_{ij} ​$,若dD,则 v=1,若 $  d_{ij} ​$ > D ,则 $ w_{ij} ​$= 0 (公式 2 )。应用该权重矩阵时,可能会出现一些较小空间单元具有相对较多的邻近单元,而较大的地理单元则可能很少,甚至没有邻近单元。这在空间权重矩阵设置中是比较忌讳的。
$$
w_{ij} = \left\{
\begin{aligned}
1 & & 当空间单元 i 和 j 的距离 d_{ij} \le D  \\
0 & & 当空间单元 i 和 j 的距离 d_{ij} \gt D   \\
0 & & 当 i = j
\end{aligned}
\right. \tag{2}
$$

2 ) K 最近点权重矩阵
为了在一定程度上克服阈值权重矩阵的缺点, 我们可以在给定的空间单元周围选择最近的几个单元, 给其权重赋值为 1 , 而其余的空间单元赋值为 0 ,这便是 K 最近点权重矩阵。



以上空间权重的赋值都是非 0 即 1 的, 而在实际应用中还有许多其它形式的空间权重矩阵 :

① 反距离权重矩阵,其赋值方法一般为取距离的一次倒数 ( $\frac{1} { d_{ij} }​$ ), 其空间权重值随着距离的增加逐渐降低;

② 地理因素并不是产生空间效应的唯一因素, 我们还可以从经济属性的角度设置空间权重矩阵, 这便是经济权重矩阵;

③ 有时我们还需要同时考虑经济和地理因素,这时就需要选用嵌套权重矩阵;

④ 有时候我们在设置空间权重矩阵的时候还需要考虑地理空间的可达性, 比如说考虑两地公路、铁路等交通状况。

总之, 空间权重矩阵的设定并不存在固定模式, 我们可以根据实际情况选用不冋的空间权重矩阵。考虑到布病主要是由于接触被感染的宿主而传播, 很难选取个合适的距离建立空间权重矩阵, 而此时基于邻近关系建立空间权重矩阵更加合适, 而其它考虑更多实际因素建立的空间权重矩阵也更加难以实现, 故采用基于邻近关系 Quen 准则权重矩阵。



