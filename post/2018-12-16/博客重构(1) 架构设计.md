<!-- {title_en:'blog code refactoring architect design', comment:false, modify:'2018-12-16', tags:['博客','架构'], summary:'最近看了一些微服务的教程，又起了重新设计整个博客的架构的念头，这次真的是最后一次了！'} -->

# 博客重构(1): 架构设计

最近看了一些微服务的教程，又起了重新设计整个博客的架构的念头，这次真的是最后一次了！

重新设计完的整体架构如下图。

![image-20181217154901158](image-20181217154901158-5032941.png)



首先是写博客使用的是 Typora ，一款 Mac 版的 Markdown 编写工具，能够支持图片的粘贴上传，界面也很合我的胃口。写完以后通过 git push 上传至 github，github 会调用 webhook 通知博客服务更新。

其次前端页面使用 vue 来开发，博客的内容都是 markdown 格式的，前端获取之后通过 markd 插件转换为 html 页面。所有的API 被设计成 REST 风格，主要有三种 API：

1. 博客的列表和详情 API
2. 博客的标签相关 API
3. 博客的评论相关 API

后台服务使用 springboot 来开发，springboot 非常好用，配置少，代码简洁。将原来的邮件通知和短信通知抽离出博客系统，以后写其他的应用也可以使用消息服务。使用 thrift 做接口，thrift 是 google 的一款 RPC 框架，效率高，跨语言。博客服务、前端服务、消息服务都通过 docker 打成镜像，上传至服务器运行。

实现了使用 markdown 格式写博客，然后传到 github，博客服务从 github 拉取代码生成 Web 页面功能。其实一个博客服务不用搞这么复杂，主要是想练练手，前后端代码分离、博客静态化、微服务的开发思想、自动化运维都理了一遍。

